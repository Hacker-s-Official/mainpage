<style>
    #header-main{
        width:100%;
        height:2rem;
        position: fixed;
        top:0;
        left:0;
        background-color: rgb(192, 192, 192);
        z-index: 100;
    }
    #header-main #homelink img{
      height:2rem;
    }
    #header-main #change-dark{
      background-color:transparent;
      border:none;
    }
    #header-main #change-dark img{
      height:1.5rem;
    }
  
</style>
<div id='header-main'>
    <a href="https://Liberluna.github.io/mainpage" style="color:#000" id="homelink">
      <img src="img/Liberluna.svg" alt="Liberluna">
    </a>
    <button id="change-dark">
      <img src="img/darkmode.svg" id="dark" hidden>
      <img src="img/lightmode.svg" id="light" hidden>
    </button>
   
<script>
  (()=>{
    'use strict';
    const isLight=()=>!window.matchMedia('(prefers-color-scheme: dark)').matches;
    function changeMode(){
      document.querySelector("#header-main #change-dark #dark").hidden=localStorage.getItem("light")==="true";
      document.querySelector("#header-main #change-dark #light").hidden=localStorage.getItem("light")!=="true";
      const mode=localStorage.getItem("light")!=="true";
      document.querySelectorAll("*").forEach(e=>{
        e.dark=mode;
      })
    }
    document.querySelector("#header-main #change-dark").addEventListener('click',e=>{
      localStorage.setItem("light",localStorage.getItem("light")!=="true");
      changeMode();
    })
    function getLightChange(){
      if(localStorage.getItem("lastLight")===null){
        //init
        localStorage.setItem("lastLight",isLight());
      }
      if(localStorage.getItem("light")===null){
        //init light mode
        localStorage.setItem("light",isLight());
        changeMode();
      }
      if(localStorage.getItem("lastLight")!==isLight().toString()){
        // catch change
        localStorage.setItem("lastLight",isLight());
        localStorage.setItem("light",isLight());
        changeMode();
      }
      setTimeout(getLightChange,100);
    }
    changeMode();
    setTimeout(getLightChange,100);
  })()
</script>
